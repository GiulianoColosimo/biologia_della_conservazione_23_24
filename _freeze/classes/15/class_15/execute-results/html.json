{
  "hash": "87abfbf9c05731a0068e2a5b46edbbb2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Biologia della Conservazione\"\nsubtitle: \"Class 15 - Heritability\"\ndate: \"2024-05-14\"\nfooter:  \"[Biologia della conservazione 23/24 - Giuliano Colosimo, PhD](https://giulianocolosimo.github.io/biologia_della_conservazione_23_24/)\"\nlogo: ../../figures/Tor-Vergata_logo_cmyk.png\nformat: \n  revealjs:\n    width: 1600\n    height: 900 \n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\n    preview-links: true\n    chalkboard: \n      boardmarker-width: 5\neditor: visual\nfrom: markdown+emoji\nexecute:\n  freeze: auto\neditor_options: \n  chunk_output_type: console\nbibliography: /Users/giulianocolosimo/Library/CloudStorage/ProtonDrive-giuliano.colosimo@protonmail.com/manuscripts/literature/bibtex/comprehensive_database.bib\ncsl: /Users/giulianocolosimo/Library/CloudStorage/ProtonDrive-giuliano.colosimo@protonmail.com/manuscripts/literature/bibtex/apa_5th_edition.csl\ncitation_package: biblatex\ncitecolor: \"red\"\n---\n\n\n\n\n## Topics\n\n::: columns\n::: {.column width=\"50%\"}\n1.  [Introduction to conservation biology]{style=\"color: green;\"}\n2.  [Biodiversity]{style=\"color: green;\"}\n3.  [Biodiversity and extinctions]{style=\"color: green;\"}\n4.  [Populations]{style=\"color: green;\"}\n5.  [Basics of conservation genetics]{style=\"color: green;\"}\n6.  [Genetic drift]{style=\"color: green;\"}\n7.  [Effective population size]{style=\"color: green;\"}\n8.  [Inbreeding depression]{style=\"color: green;\"}\n9.  [Population structure]{style=\"color: green;\"}\n10. [Hybridization]{style=\"color: green;\"}\n11. [Applying genetic information to conservation]{style=\"color: green;\"}\n:::\n\n::: {.column width=\"50%\"}\n12. [Managing genetic diversity in captive populations]{style=\"color: orange;\"}\n13. [Managing genetic diversity in the wild]{style=\"color: orange;\"}\n14. [Population viability analysis]{style=\"color: blue;\"}\n15. [Invasive species]{style=\"color: blue;\"}\n16. [CITES and trade regulations of endangered species]{style=\"color: blue;\"}\n17. [Conservation and climate change]{style=\"color: blue;\"}\n18. [Future climate impacts]{style=\"color: blue;\"}\n19. [Conservation economics]{style=\"color: blue;\"}\n20. [Conservation technology]{style=\"color: blue;\"}\n:::\n:::\n\n## Heritability\n\nWhen talking about phenotypes we have mentioned that a measurable phenotype is the consequence of the underlying genotypes inherited by the parents plus the influence of the environment. We can represent this relation in mathematical terms in the following way:\n\n$$\n\\label{p}\n\\tag{15.1}\nP = G + E\n$$\n\nwhere $P$ = phenotye, $G$ = genotype, and $E$ = environment. Being able to distinguish between the genetic and the environmental component in this interaction is important to understand the evolutionary trajectory of a population or species [@Frankham2010].\n\nDifferent phenotypes within a population, also known as phenotypic variance $V_P$, represents the sum total of all the interactions between the genotypic variance, $V_G$, the environmental variance, $V_E$, and the interaction term between these two quantities, $G*E$.\n\n$$\n\\label{Vp}\n\\tag{15.2}\nV_P = V_G + V_E + 2Cov_{GE}\n$$\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n![Quantitative genetic variation for corolla length in tobacco. After @Strickberger1985.](./class_14_7.jpg){width=\"70%\"}\n:::\n\n::: {.column width=\"50%\"}\n-   Variances for corolla length in the two homozygous parent population are 48 and 32 respectively.\n-   Variance in the $F_1$ population is 46, while variance in the $F_2$ population is 130.5.\n-   The variances in the parental and $F_1$ populations are due solely on environmental variance, $V_E$.\n-   We can average the three separate estimates of $V_E = \\frac{48+32+46}{3}=42$.\n-   In $F_2$ we need to account for both genetic variation and environmental variation: $V_{F_2} = V_G+V_E = 130.5$, and we can rearrange the equation as $V_G = V_{F_2} - V_E = 130.5- 42 = 88.5$.\n:::\n:::\n\n------------------------------------------------------------------------\n\n-   Based on the previous example, we can conclude that in $F_2$ generation $88/130.5 = 68\\%$ of variance is due to segregation of polymorphic loci while only $100-68=32\\%$ of the total phenotypic variance is due to environmental factors ($V_E$).\n-   In common garden experiment the covariance term in equation \\ref{p} can be kept under control by standardizing the experimental condition for the animal or plant under study.\n-   This is way more complicated to obtain in wild populations as the there is no easy way to keep under control the many environmental variables that play into the reproductive fitness of individuals.\n\n. . .\n\n### Further partitioning $V_G$\n\nWe can further divide the genetic variance in three subcomponents: additive genetic variance ($V_A$), dominance variance ($V_D$) and interacting variance ($V_I$).\n\n$$\n\\label{Vg}\n\\tag{15.3}\nV_G= V_A+V_D+V_I\n$$\n\n------------------------------------------------------------------------\n\n-   $V_A$ reflects variation in the avergae effect of the many loci involved in the overall genotypic variance. This measure, and in particular the ratio $V_A/V_P$ (also known as heritability) reflects the evolutionary potential of the population or species under study [@Frankham2010].\n-   $V_D$ measures variation in dominance deviation.\n-   $V_I$ is a measure of epistasis, i.e. the variation in interaction deviations among genes. This can also be interpreted as a measure of the effects of outbreeding, whether beneficial or deleterious [@Frankham2010].\n\n. . .\n\n-   To better understand the meaning of $V_A$ and $V_D$ we can work a simple model to help illustrate how we can partition the genetic variance in its component, in particular the additive and the dominant ones ($V_A$ and $V_D$)!\n\n------------------------------------------------------------------------\n\n![Genotypic values assigned to three genotypes at a locus along with their frequencies with random mating [@Frankham2010]](./class_15_1.jpg)\n\n. . .\n\n![Genotypic values for additive, dominant and overdominant loci [@Frankham2010]](./class_15_2.jpg)\n\n------------------------------------------------------------------------\n\n-   In Merino sheep the $B$ allele increases the litter size. Based on some experimental studies we can compute the following average litter size for the three distinct genotypes:\n\n| BB   | Bb   | bb   |\n|------|------|------|\n| 2.66 | 2.17 | 1.48 |\n\n-   We can now compute the value of $a$ as:\n\n$$\na = \\frac{BB \\ value- bb \\ value}{2} = \\frac{2.66-1.48}{2}=0.59\n$$\n\n-   Based on our model, the mid-point between the two homozygotes is the zero point on the scale of genotypic values, and we can use it to determine $d$. It is calculated as $(2.66-0.59 = 2.07)$. We can now calculate the dominance deviation $d$ as:\n\n$$\nd= Bb \\ value - mid \\ point = 2.17-2.07=0.10\n$$\n\n------------------------------------------------------------------------\n\n-   Each copy of the $B$ allele increases the litter size by an average of 0.59 offspring and this allele presents partial dominance with the heterozygote having 0.10 offspring above the $bb$ homozygote.\n\n. . .\n\n### Focusing on additive genetic variance ($V_A$)\n\n![Genotypic values assigned to three genotypes at a locus along with their frequencies with random mating [@Frankham2010]](./class_15_1.jpg)\n\n-   For a polymorphic locus with addivie effects ($d = 0$) and genotypic frequncies and values as in the above example, the additive genetic variation is defined as $V_A = 2pqa^2$.\n\n------------------------------------------------------------------------\n\n-   We can desume that $V_A$ is directly dependent on the heterozygosity (2pq) and ha;f the differenc in genotypic values between the two homozygotes ($a$).\n-   The larger the difference between the two homozygotes the larger $V_A$.\n-   On the other end, when $d \\ne 0$ (there is dominance) the additive genetic variation can be computed as:\n\n$$\n\\label{vadom}\n\\tag{15.4}\nV_A = 2pq[a+d(q-p)]^2\n$$\n\n-   Thus, $V_A$ also depends on the dominance deviation!\n\n-   As you can guess, $V_A$ of a specific character depends on the combined effect of all segregating loci in a population with effect on the specific quantitative character under study [@Frankham2010].\n\n------------------------------------------------------------------------\n\n## Heritability and Evolutionary potential\n\n-   Heritability determines the extent to which a character is passed on from parents to offspring. Only traits that are heritable will be passed on from generation to generation. A trait that is favorable, but it is not heritable will not be passed on!\n\n-   Heritability ($h^2$) is defined as the proportion of total phenotypic variation due to additive genetic variance:\n\n$$\n\\label{h2}\n\\tag{15.5}\nh^2 = \\frac{V_A}{V_P}\n$$\n\n-   $h^2$ value ranges from $0$ to $1$, with $0$ characteristic of highly inbred populations with no genetic variation, and $1$ expected in traits with basically no environmental variance components and all additive genetic variance.\n-   Heritability can not be extrapolated for environments that are not native to population or species under study.\n\n------------------------------------------------------------------------\n\n-   Quantitative variation is characterized using statistical parameters including means, variances, covariances, regressions and correlations [@Frankham2010].\n\n. . .\n\n| Parent means (P) | Offspring means (O) |\n|------------------|---------------------|\n| 6.8              | 7.3                 |\n| 6.9              | 7.4                 |\n| 7.1              | 7.6                 |\n| 7.3              | 7.5                 |\n| 7.3              | 7.3                 |\n| 7.3              | 7.2                 |\n| 7.4              | 7.4                 |\n| 7.5              | 7.7                 |\n| 7.5              | 7.6                 |\n\nData from [@Murray1968].\n\n------------------------------------------------------------------------\n\n-   Mean: $\\bar{P}=\\frac{\\sum_{i=1}^n P_i}{n}$ and $\\bar{O}=\\frac{\\sum_{i=1}^n O_i}{n}$\n\n. . .\n\n-   Variance: $V_{P}=\\frac{\\sum_{i=1}^n (P_i-\\bar{P})^2}{n-1}$ and $V_{O}=\\frac{\\sum_{i=1}^n (O_i-\\bar{O})^2}{n-1}$\n\n. . .\n\n-   Standard deviations: $sd_{P} = \\sqrt{V_{P}}$ and $sd_{O} = \\sqrt{V_{O}}$\n\n. . .\n\n-   Covariance ($Cov_{PO}$) measures the extent to which they vary in concert ($+$), they vary independently ($0$), or in opposition ($-$): $Cov_{PO} = \\frac{\\sum_{i=1}^n (P_i-\\bar{P})(O_i-\\bar{O})}{n-1}$\n\n. . .\n\n-   Correlation ($r_{PO}$) is a standardized measure of how two measurements vary in concert. Ranges from $-1$ to $+1$: $r_{PO} = \\frac{Cov_{PO}}{\\sqrt{(V_{P}*V_{O})}}$\n\n. . .\n\n-   Regression of offspring on parents ($b_{OP}$) is the slope of the line of best fit relating offspring and parents: $b_{OP}= \\frac{Cov_{PO}}{V_{P}}$\n\n------------------------------------------------------------------------\n\n-   Access the [data for excercise](https://drive.proton.me/urls/5RKA9GC418#RwMAMxHGaHl2) and lets try to estimate the heritability in R.\n\n-   Save the file in a specific folder and navigate to that folder within R.\n\n\n::: {.cell}\n\n:::\n\n\n-   Load the data file in your working environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"path_to_file.RData\")\n```\n:::\n\n\n-   Lets take a look at the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Parent means complete dataset\nP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 6.8 6.9 6.9 7.1 7.3 7.3 7.3 7.4 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.6 7.6 7.6 7.6\n[20] 7.6 7.6 7.7 7.7 7.8 7.8 7.8 7.8 7.8 7.9 7.9 7.9 7.9 7.9 8.0 8.0 8.0 8.1 8.1\n[39] 8.1 8.5\n```\n\n\n:::\n\n```{.r .cell-code}\n# Offspring means complete dataset\nO\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 7.3 7.4 7.6 7.5 7.3 7.2 7.4 7.7 7.6 7.5 7.7 7.4 7.8 7.6 7.3 7.7 7.7 7.9 7.4\n[20] 7.5 7.4 7.6 7.9 7.5 7.8 7.9 7.6 7.5 7.6 7.7 7.7 7.7 7.8 7.7 7.9 7.8 7.8 7.8\n[39] 7.9 8.1\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n-   Mean\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(P)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.645\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(O)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.63\n```\n\n\n:::\n:::\n\n\n-   Variance\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar(P)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1251026\n```\n\n\n:::\n\n```{.r .cell-code}\nvar(O)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.04266667\n```\n\n\n:::\n:::\n\n\n-   Standard deviation\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(P)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3536984\n```\n\n\n:::\n\n```{.r .cell-code}\nsd(O)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2065591\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n-   Covariance\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncov(P,O)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.04964103\n```\n\n\n:::\n:::\n\n\n. . .\n\n-   Correlation\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(P,O)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.679459\n```\n\n\n:::\n:::\n\n\n-   Regression\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(O ~ P, xlab = \"Parent means\", ylab = \"Offspring means\")\n```\n\n::: {.cell-output-display}\n![](class_15_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(O ~ P))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = O ~ P)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.293103 -0.097863 -0.002623  0.094215  0.287856 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  4.59644    0.53196   8.641 1.68e-10 ***\nP            0.39680    0.06951   5.709 1.43e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1535 on 38 degrees of freedom\nMultiple R-squared:  0.4617,\tAdjusted R-squared:  0.4475 \nF-statistic: 32.59 on 1 and 38 DF,  p-value: 1.429e-06\n```\n\n\n:::\n:::\n\n\n1.  The estimate for the model parameters -- the value of the y-intercept (in this case 4.596) and the estimated effect of parents on offspring (0.396).\n2.  The standard error of the estimated values (Std. Error).\n3.  The test statistic (t value, in this case the t statistic).\n4.  The p value ( Pr(\\>\\| t \\| ) ), aka the probability of finding the given t statistic if the null hypothesis of no relationship were true.\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(O ~ P, xlab = \"Parent means\", ylab = \"Offspring means\")\nabline(lm(O ~ P))\n```\n\n::: {.cell-output-display}\n![](class_15_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n![Hypothetical relationships between mean values of parents and mean values of offspring for three cases, representing (a) complete, (b) incomplete, and (c) zero relationships between parents and offspring [@Frankham2010].](./class_15_3.jpg)\n\na.  Parents with larger values produce offspring with larger values, $h^2 = 1$.\nb.  Parents with high phenotypic values produce offspring with slightly higher phenotypic values, but still close to the population mean, $h^2$ has an intermediate value.\nc.  Parents with high and low values have similar offspring.\n\n------------------------------------------------------------------------\n\n## Predicting response to selection\n\n-   The genetic change (response) produced by directional selection can be predicted from the intensity of selection and the heritability.\n\n. . .\n\n![Forms of selection operating on quantitative characters After @Frankham2010 and @Futuyma1979.](./class_15_4.jpg){width=\"40%\"}\n\n------------------------------------------------------------------------\n\n![Predicting response to directional selection. Individuals with the highest values are selected to be parents (filled circles), and their mean phenotype value, $S$, is higher than the mean of the general parental population After [@Frankham2010].](./class_15_5.jpg)\n\n------------------------------------------------------------------------\n\n-   $S$ is termed selection differential.\n-   $R$ is termed response to selection (the difference in the offspring of selected parents against the offspring of all parents) can be measured as:\n\n$$\n\\label{R}\n\\tag{15.6}\nR = Sh^2\n$$\n\n::: columns\n::: {.column width=\"50%\"}\n![Darwin's medium ground finches from Galápagos. After @Frankham2010](./class_15_6.jpg){width=\"30%\"}\n:::\n\n::: {.column width=\"50%\"}\n-   Over 18 months of drought and no breeding the finches suffered 85% mortality.\n-   Survivors had beaks that were 0.25mm wider than the original population ($S$).\n-   The heritability for bill width in this population is 74.5%.\n-   Can we predict the genetic change of the offspring of these survivors ($R$)?\n:::\n:::\n\n\n## References",
    "supporting": [
      "class_15_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}