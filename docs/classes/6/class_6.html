<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-04-09">

<title>Biologia della Conservazione 23/24 - Biologia della Conservazione</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../../site_libs/htmltools-fill-0.5.8/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.32/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="Biologia della Conservazione 23/24 - Biologia della Conservazione">
<meta property="og:description" content="Class 6 - Conservation genetics">
<meta property="og:image" content="https://giulianocolosimo.github.com/classes/6/hardy.jpg">
<meta property="og:site-name" content="Biologia della Conservazione 23/24">
<meta property="og:locale" content="en_US">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Biologia della Conservazione 23/24</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../calendar.html" rel="" target="">
 <span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html" rel="" target="">
 <span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Biologia della Conservazione</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../.././figures/avatar.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="mailto:giuliano.colosimo@protonmail.com" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Classes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/1/class_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 1 - Introduction to conservation biology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/2/class_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 2 - Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/3/class_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 3 - Biodiversity &amp; Extinctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/4/class_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 4 - Populations (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/5/class_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 5 - Populations (2) - Intro to Conservation Genetics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/6/class_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 6 - Conservation Genetics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/7/class_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 7 - Genetic Drift/Effective Population Size</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/8/class_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 8 - Manuscript discussion-Genetic Drift/Effective Population Size</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/9/class_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 9 - Manuscript discussion-Genetic Drift/Effective Population Size</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../.././classes/10/class_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 10 - Inbreeding</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#topics" id="toc-topics" class="nav-link active" data-scroll-target="#topics">Topics</a></li>
  <li><a href="#fundamental-measures-of-genetic-diversity" id="toc-fundamental-measures-of-genetic-diversity" class="nav-link" data-scroll-target="#fundamental-measures-of-genetic-diversity">Fundamental measures of genetic diversity</a></li>
  <li><a href="#the-simpler-model-hardy-weinberg-principle" id="toc-the-simpler-model-hardy-weinberg-principle" class="nav-link" data-scroll-target="#the-simpler-model-hardy-weinberg-principle">The simpler model: Hardy-Weinberg principle</a>
  <ul class="collapse">
  <li><a href="#analyzing-the-hardy-weinberg-model" id="toc-analyzing-the-hardy-weinberg-model" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-1" id="toc-analyzing-the-hardy-weinberg-model-1" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-1">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-2" id="toc-analyzing-the-hardy-weinberg-model-2" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-2">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-3" id="toc-analyzing-the-hardy-weinberg-model-3" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-3">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-4" id="toc-analyzing-the-hardy-weinberg-model-4" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-4">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-5" id="toc-analyzing-the-hardy-weinberg-model-5" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-5">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-6" id="toc-analyzing-the-hardy-weinberg-model-6" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-6">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-7" id="toc-analyzing-the-hardy-weinberg-model-7" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-7">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-8" id="toc-analyzing-the-hardy-weinberg-model-8" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-8">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-9" id="toc-analyzing-the-hardy-weinberg-model-9" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-9">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-10" id="toc-analyzing-the-hardy-weinberg-model-10" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-10">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-11" id="toc-analyzing-the-hardy-weinberg-model-11" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-11">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-12" id="toc-analyzing-the-hardy-weinberg-model-12" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-12">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-13" id="toc-analyzing-the-hardy-weinberg-model-13" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-13">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-14" id="toc-analyzing-the-hardy-weinberg-model-14" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-14">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-15" id="toc-analyzing-the-hardy-weinberg-model-15" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-15">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#analyzing-the-hardy-weinberg-model-16" id="toc-analyzing-the-hardy-weinberg-model-16" class="nav-link" data-scroll-target="#analyzing-the-hardy-weinberg-model-16">Analyzing the Hardy-Weinberg model</a></li>
  <li><a href="#summary-of-the-hardy-weinberg-model" id="toc-summary-of-the-hardy-weinberg-model" class="nav-link" data-scroll-target="#summary-of-the-hardy-weinberg-model">Summary of the Hardy-Weinberg model</a></li>
  <li><a href="#testing-a-null-hypothesis" id="toc-testing-a-null-hypothesis" class="nav-link" data-scroll-target="#testing-a-null-hypothesis">Testing a null hypothesis</a></li>
  <li><a href="#excercise-to-test-the-hw-proportions" id="toc-excercise-to-test-the-hw-proportions" class="nav-link" data-scroll-target="#excercise-to-test-the-hw-proportions">Excercise to test the HW proportions</a></li>
  </ul></li>
  <li><a href="#is-this-difference-significant" id="toc-is-this-difference-significant" class="nav-link" data-scroll-target="#is-this-difference-significant">Is this difference significant?</a>
  <ul class="collapse">
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of freedom</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/quarto-dev/quarto-demo/issues/new" class="toc-action">Report an issue</a></p></div></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="class_6.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biologia della Conservazione</h1>
<p class="subtitle lead">Class 6 - Conservation genetics</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 9, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="topics" class="level2">
<h2 class="anchored" data-anchor-id="topics">Topics</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><span style="color: green;">Introduction to conservation biology</span></li>
<li><span style="color: green;">Biodiversity</span></li>
<li><span style="color: green;">Biodiversity and extinctions</span></li>
<li><span style="color: green;">Populations</span></li>
<li><span style="color: orange;">Basics of conservation genetics</span></li>
<li><span style="color: blue;">Genetic drift</span></li>
<li><span style="color: blue;">Effective population size</span></li>
<li><span style="color: blue;">Inbreeding depression</span></li>
<li><span style="color: blue;">Population structure</span></li>
<li><span style="color: blue;">Hybridization</span></li>
<li><span style="color: blue;">Applying genetic information to conservation</span></li>
</ol>
</div><div class="column" style="width:50%;">
<ol start="12" type="1">
<li><span style="color: blue;">Managing genetic diversity in captive populations</span></li>
<li><span style="color: blue;">Managing genetic diversity in the wild</span></li>
<li><span style="color: blue;">Population viability analysis</span></li>
<li><span style="color: blue;">Invasive species</span></li>
<li><span style="color: blue;">CITES and trade regulations of endangered species</span></li>
<li><span style="color: blue;">Conservation and climate change</span></li>
<li><span style="color: blue;">Future climate impacts</span></li>
<li><span style="color: blue;">Conservation economics</span></li>
<li><span style="color: blue;">Conservation technology</span></li>
</ol>
</div>
</div>
</section>
<section id="fundamental-measures-of-genetic-diversity" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-measures-of-genetic-diversity">Fundamental measures of genetic diversity</h2>
<ul>
<li>Polymorphism</li>
</ul>
<p><span class="math display">\[
P = number\ of\ polymorphic\ loci/total\ number\ of\ loci
\]</span></p>
<ul>
<li>Allele frequency (for diploid individuals)</li>
</ul>
<p><span class="math display">\[
p = \frac{2n_{Hom} + n_{Het}}{2n}
\]</span> where <span class="math inline">\(p\)</span> is the frequency of the allele (usually the dominant one) and <span class="math inline">\(n\)</span> is the number of individuals that are homozygotes (<span class="math inline">\(n_{Hom}\)</span>) and heterozygotes (<span class="math inline">\(n_{Het}\)</span>) for that allele, respectively</p>
<ul>
<li>Average heterozygosity <span class="math inline">\(H = \sum H_i/N\)</span> where <span class="math inline">\(H_i\)</span> is the average heterozygosity at locus <span class="math inline">\(i\)</span>, and <span class="math inline">\(N\)</span> is the total number of loci</li>
</ul>
<hr>
<ul>
<li>Describing the genetic variation using mathematical tool is a good and necessary exercise, but it is not enough!</li>
<li>We need to develop models that could tell us about how various evolutionary factors (natural selection, mutations, population size, geographic fragmentation, drift) affect the persistence of populations and species</li>
</ul>
<blockquote class="blockquote">
<p>Models are essential for understanding the genetics of natural populations in a variety of ways: <em>i)</em> models make us define the parameters that need to be considered; <em>ii)</em> models allow us to test hypotheses; <em>iii)</em> models allow us to generalize results; iv) models allow us to predict how a system will operate in the future <span class="citation" data-cites="Allendorf2022">(<a href="#ref-Allendorf2022" role="doc-biblioref">Allendorf et al., 2022, p. 95</a>)</span>.</p>
</blockquote>
<ul>
<li>As a general rule of thumb, models that we develop to understand natural populations should be as simple as possible
<ul>
<li>Simpler models are easier to reject, and, therefore, are more useful</li>
<li>Simple models are likely to be more general and therefore more applicable to a wider number of situations <span class="citation" data-cites="Allendorf2022">(<a href="#ref-Allendorf2022" role="doc-biblioref">Allendorf et al., 2022, p. 95</a>)</span></li>
</ul></li>
</ul>
<hr>
</section>
<section id="the-simpler-model-hardy-weinberg-principle" class="level2">
<h2 class="anchored" data-anchor-id="the-simpler-model-hardy-weinberg-principle">The simpler model: Hardy-Weinberg principle</h2>
<ul>
<li>In 1908, Godfrey Harold Hardy (a British mathematician) and Wilhelm Weinberg (a German physician), independently developed a math model describing the dynamics of a diploid, sexually reproducing population</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./hardy.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Gregory Harol Hardy, figure from the Wiki page</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./weinberg.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Wilhelm Weinberg, figure from <a href="http://www.esp.org/people/" class="uri">http://www.esp.org/people/</a></figcaption>
</figure>
</div>
</div>
</div>
<hr>
<ul>
<li>Hardy-Weinberg model suggests that a population reaches an equilibrium where allele frequencies are constant and there is a specific relation between genotypic and allelic frequencies</li>
</ul>
<p>. . .</p>
<p>Assumptions of the model:</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Random mating</td>
<td>Individuals show no significant preference or dislike for other individuals with respect to specific traits or loci.</td>
</tr>
<tr class="even">
<td>No mutation</td>
<td>Mutation is one of the few forces creating variability. We assume that the information is transmitted from generation to generation without the influence of mutation.</td>
</tr>
<tr class="odd">
<td>Infinite population size</td>
<td>No population in nature is actually infinite (although populations of some species may as well be)! This assumption is fundamental to construct a null model and compare the effect of small population size.</td>
</tr>
</tbody>
</table>
<hr>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>(continues)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No natural selection</td>
<td>We will assume that all alleles and genotypes have the same fitness and that there is no differential reproduction or survival. This assumption is very unlikely to be true in nature, especially because selection may be reduced for the loci under analysis, but still present at all other loci in an individual.</td>
</tr>
<tr class="even">
<td>No immigration</td>
<td>We will first consider a situation where only one population of a certain species is present. This means that we will not consider gene flow and exchange of genetic material from and to other populations.</td>
</tr>
</tbody>
</table>
<p>. . .</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is the main consequence of the assumptions we have just described?</p>
</div>
</div>
<p>. . .</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
</div>
<div class="callout-body-container callout-body">
<p>The main outcome of these assumptions is that the population under study is a population that doesn’t evolve!</p>
</div>
</div>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class_6_files/figure-html/hwProps-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Organization of genetic variability in a Hardy-Weinberg equilibrium population typed at a biallelic locus</figcaption>
</figure>
</div>
</div>
</div>
<hr>
<section id="analyzing-the-hardy-weinberg-model" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model">Analyzing the Hardy-Weinberg model</h3>
<section id="a-walk-through-example" class="level4">
<h4 class="anchored" data-anchor-id="a-walk-through-example">A walk-through example</h4>
<ul>
<li>We begin considering a diploid population with n = 15 individuals</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./population10a.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
</section>
<section id="analyzing-the-hardy-weinberg-model-1" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-1">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li>Being diploids each individual has two alleles per locus (A and a)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./population10c.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-2" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-2">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li>Summarizing the information as a table…</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(n_{AA}\)</span></th>
<th><span class="math inline">\(n_{Aa}\)</span></th>
<th><span class="math inline">\(n_{aa}\)</span></th>
<th><span class="math inline">\(n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>7</td>
<td>2</td>
<td>15</td>
</tr>
</tbody>
</table>
<ul>
<li>… and estimating the allele frequencies:</li>
</ul>
<p><span class="math display">\[
p = f(A) = \frac{2n_{AA} + n_{Aa}}{2n} = \frac{12 + 7}{30} \approx 0.633
\]</span> and</p>
<p><span class="math display">\[
q = f(a) = \frac{2n_{aa} + n_{Aa}}{2n}= \frac{4 + 7}{30} \approx 0.367
\]</span></p>
<ul>
<li>Since there are only two alleles we can write <span class="math inline">\(p + q = 1\)</span></li>
</ul>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-3" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-3">Analyzing the Hardy-Weinberg model</h3>
<section id="expansion-of-the-hardy-weinberg-model-with-multiple-alleles" class="level4">
<h4 class="anchored" data-anchor-id="expansion-of-the-hardy-weinberg-model-with-multiple-alleles">Expansion of the Hardy-Weinberg model with multiple alleles</h4>
<ul>
<li><p>In this previous basic example we only had 2 alleles and therefore <span class="math inline">\(p+q=1\)</span>.</p></li>
<li><p>Because of our assumption of random mating the assortment of alleles in the zygotes can be estimated from the allele frequencies using a binomial expansion:</p></li>
</ul>
<p><span class="math display">\[
(p+q)^2=p^2+2pq+q^2
\]</span></p>
<ul>
<li>If we want to add another allele (<span class="math inline">\(A_1, A_2, A_3\)</span>)…</li>
</ul>
<p><span class="math display">\[
(p+q+r)^2=p^2+2pq+q^2+2pr+2qr+r^2
\]</span></p>
<hr>
</section>
</section>
<section id="analyzing-the-hardy-weinberg-model-4" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-4">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li><p>“All alleles and genotypes have the same fitness with no differential reproduction or survival” and individuals are “mating at random”</p></li>
<li><p>If this is true, the frequencies of male and female gametes correspond to the allele frequencies and zygotes are formed randomly choosing gametes from the gene pool</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePool.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-5" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-5">Analyzing the Hardy-Weinberg model</h3>
<section id="basic-probability-theory" class="level4">
<h4 class="anchored" data-anchor-id="basic-probability-theory">Basic probability theory</h4>
<ul>
<li>The probability of two independent events, such as the union of two gametes at random in a zygote, is calculated as the product of the probability of the single events</li>
</ul>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dice <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6</code></pre>
</div>
</div>
<p><br></p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(dice, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p><br></p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(dice, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p><br></p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sim_dice <span class="ot">&lt;-</span> <span class="fu">sample</span>(dice, <span class="at">size =</span> <span class="dv">100000</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">replace =</span> T)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sim_dice)<span class="sc">/</span><span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sim_dice
      1       2       3       4       5       6 
0.16720 0.16622 0.16668 0.16557 0.16766 0.16667 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="analyzing-the-hardy-weinberg-model-6" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-6">Analyzing the Hardy-Weinberg model</h3>
<section id="basic-probability-theory-1" class="level4">
<h4 class="anchored" data-anchor-id="basic-probability-theory-1">Basic probability theory</h4>
<ul>
<li>The probability of casting a dice and obtaining one of the six numbers is <span class="math inline">\(\frac{1}{6} \approx 0.16\)</span>. The probability of casting the dice twice and obtaining the same number is <span class="math inline">\(\frac{1}{6} * \frac{1}{6} = \frac{1}{36} \approx 0.028\)</span></li>
</ul>
</section>
<section id="the-punnet-square" class="level4">
<h4 class="anchored" data-anchor-id="the-punnet-square">The Punnet square</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class_6_files/figure-html/punnet-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="analyzing-the-hardy-weinberg-model-7" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-7">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li>We want to recreate a sample of 15 individuals starting from the gamete pool of our original population with <span class="math inline">\(n = 15\)</span> and <span class="math inline">\(p \approx 0.633\)</span> and <span class="math inline">\(q \approx 0.367\)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePoolHWA0.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-8" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-8">Analyzing the Hardy-Weinberg model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.633</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fl">0.367</span>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"a"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(p, q))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePoolHWA1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-9" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-9">Analyzing the Hardy-Weinberg model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"a"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(p, q)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePoolHWA2.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-10" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-10">Analyzing the Hardy-Weinberg model</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePoolHWA16.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-11" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-11">Analyzing the Hardy-Weinberg model</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./genePoolHWA30.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li>We summarize the results in a table</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(n_{AA}\)</span></th>
<th><span class="math inline">\(n_{Aa}\)</span></th>
<th><span class="math inline">\(n_{aa}\)</span></th>
<th><span class="math inline">\(n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>7</td>
<td>1</td>
<td>15</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-12" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-12">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li>The genotype and allele frequencies of the new generation are different from the previous one</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.633</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fl">0.367</span>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>newSample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"a"</span>), <span class="at">size =</span> <span class="dv">30</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(p, q),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">replace =</span> T)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(newSample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>newSample
 a  A 
11 19 </code></pre>
</div>
</div>
<ul>
<li>Once again, the genotype and allele frequencies of the new generation are different from the previous one, and it will likely be different most of the time we do this again</li>
</ul>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-13" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-13">Analyzing the Hardy-Weinberg model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code has been modified from prof. Gratton</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>newSample <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="cf">function</span>(i){<span class="fu">table</span>(<span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"a"</span>), <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fu">c</span>(p,q), <span class="at">replace =</span> T),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"a"</span>)))}))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(newSample[,<span class="st">"A"</span>]<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">"f(A)"</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by=</span> <span class="fl">0.1</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkgoldenrod3"</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="cn">NA</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"10,000 samples of size 30"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="dv">2</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.637</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class_6_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-14" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-14">Analyzing the Hardy-Weinberg model</h3>
<ul>
<li><p>We notice that there is a oretty large variability around the original value of p = 0.633</p></li>
<li><p>In other words, the sampling error is quite large</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class_6_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-15" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-15">Analyzing the Hardy-Weinberg model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>newSample <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="cf">function</span>(i){<span class="fu">table</span>(<span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"a"</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fu">c</span>(p,q), <span class="at">replace =</span> T),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"a"</span>)))}))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(newSample[,<span class="st">"A"</span>]<span class="sc">/</span><span class="dv">100</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">"f(A)"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by=</span> <span class="fl">0.01</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkgoldenrod3"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="cn">NA</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"10,000 samples of size 100"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="dv">2</span>, <span class="at">cex.main =</span> <span class="dv">2</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.637</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class_6_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="analyzing-the-hardy-weinberg-model-16" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-hardy-weinberg-model-16">Analyzing the Hardy-Weinberg model</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./samplingError.png" class="img-fluid figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="summary-of-the-hardy-weinberg-model" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-the-hardy-weinberg-model">Summary of the Hardy-Weinberg model</h3>
<ul>
<li><p>The larger the sample dimension, the lower is the variation in allele frequencies with respect to the original value</p></li>
<li><p>If all the assumptions of the HW model are met, we should expect no variation at all in allele frequency, generation after generation</p></li>
<li><p>In natural population it is very hard to meet all the assumptions of the HW, in particular the one of infinite population size</p></li>
<li><p>The HW model is a very effective and simple way to “see” the effects of various evolutionary forces operating at the population level. It provides a “null model” against which compare what we see in our data</p></li>
<li><p>Once we found that something is different between what we expect from the HW model and what we see in nature at the population genetic level, we can start investigate the relative role of the various evolutionary forces</p></li>
</ul>
<hr>
</section>
<section id="testing-a-null-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="testing-a-null-hypothesis">Testing a null hypothesis</h3>
<ul>
<li>A fundamental aspect of every scientific discipline is the capability to discern between alternative hypotheses. The general approach is to present a formal or null-hypothesis (<span class="math inline">\(H_0\)</span>) and a statistical test to estimate the probability that it holds true</li>
<li>Such test usually implies the calculation of a P-value (<em>i.e.</em>, a probability distribution)</li>
<li>Lower P-values correspond to higher degree of certainty that the null is rejected and an alternative hypothesis (<span class="math inline">\(H_1\)</span>) is preferred to explain the data</li>
<li>When <span class="math inline">\(P=0.002\)</span> it means that, if the null holds true, you expect to see a result as extreme or even more extreme than the one you have measured only 2 times out of 1000 experiment</li>
<li>The general threshold value (<span class="math inline">\(\alpha\)</span>) is <span class="math inline">\(P=0.05\)</span>, meaning that you have 5 chances in 100 of rejecting the null hypothesis when it is true</li>
</ul>
<hr>
</section>
<section id="excercise-to-test-the-hw-proportions" class="level3">
<h3 class="anchored" data-anchor-id="excercise-to-test-the-hw-proportions">Excercise to test the HW proportions</h3>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-93c78a364d7e06b3febe" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-93c78a364d7e06b3febe">{"x":{"filter":"none","vertical":false,"data":[["A1A1","A1A2","A2A2"],[907,616,124]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Genotypes<\/th>\n      <th>Number<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"name":"Genotypes","targets":0},{"name":"Number","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calculate allele frequency, genotype frequency and expected genotype frequency.</p>
</div>
</div>
<hr>
<ul>
<li>Allele frequency:</li>
</ul>
<p><span class="math display">\[
p = f(A) = \frac{2n_{11} + n_{12}}{2n} = \frac{(2*907)+616}{2*1647} =0.738
\]</span></p>
<p><span class="math display">\[
q = f(a) = \frac{2n_{22} + n_{12}}{2n} = \frac{(2*124)+616}{2*1647} =0.262
\]</span></p>
<p>. . .</p>
<ul>
<li>Observed genotype frequency:</li>
</ul>
<p><span class="math display">\[
f(AA) =\frac{n_{11}}{n}  = \frac{907}{1647}=0.551; \ \ \ f(Aa) =\frac{n_{12}}{n}  = \frac{616}{1647}=0.374
\]</span></p>
<p><span class="math display">\[
f(aa) =\frac{n_{22}}{n}  = \frac{124}{1647}=0.075
\]</span></p>
<hr>
<ul>
<li>Expected genotype frequency:</li>
</ul>
<p><span class="math display">\[
p^2 = f(AA)^2 = 0.738^2 = 0.545; \ \ \ 2pq = f(Aa) = 2*0.738*0.262=0.387
\]</span></p>
<p><span class="math display">\[
q^2 = f(aa)=0.262^2=0.068
\]</span></p>
<hr>
</section>
</section>
<section id="is-this-difference-significant" class="level2">
<h2 class="anchored" data-anchor-id="is-this-difference-significant">Is this difference significant?</h2>
<p><span class="math display">\[
\chi^2=\sum\frac{(Observed-Expected)^2}{Expected}
\]</span></p>
<ul>
<li><p>This methodology allows us to understand if the difference between observed and expected outcomes is greater than we would expect by chance</p></li>
<li><p>The empirical rule is to run the <span class="math inline">\(\chi^2\)</span> on the actual genotype count rather than the geenotype frequencies</p></li>
</ul>
<p>. . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>((<span class="dv">907</span><span class="fl">-897.615</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fl">897.615</span>)<span class="sc">+</span>((<span class="dv">616</span><span class="fl">-637.389</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fl">637.389</span>)<span class="sc">+</span>((<span class="dv">124</span><span class="fl">-111.996</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fl">111.996</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.102498</code></pre>
</div>
</div>
<ul>
<li>The computed <span class="math inline">\(\chi^2\)</span> value is compared to a set of values calculated under the assumption that the null hypothesis we are testing is correct; our null hypothesis is that the population from which the samples was drawn is in HW proportions.</li>
</ul>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> <span class="fl">2.102498</span>, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1470587</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="cell-output-display">
<p><img src="class_6_files/figure-html/chiSq2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<section id="degrees-of-freedom" class="level3">
<h3 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of freedom</h3>
<ul>
<li>The number of degrees of freedom is the number of values in the final calculation of a statistic that are free to vary <span class="citation" data-cites="Wiki_DoF_2023">(<a href="#ref-Wiki_DoF_2023" role="doc-biblioref">Wikipedia contributors, 2023</a>)</span></li>
<li>If a car dealer is giving away 15 random cars to the first 15 customers, the first 14 that show up at the car dealer will have the freedom to pick and choose the car they want. The <span class="math inline">\(15^{th}\)</span> will not be able to do so as only one car will be remaining. Similarly, if you calculated the mean of a sample of 15 numbers, the first 14 numbers can vary freely, but the value of the <span class="math inline">\(15^{th}\)</span> number is determined as the value needed to achieve the given sample mean!</li>
<li>Degrees of freedom for tests for Hardy–Weinberg proportions are estimated according to: <span class="math inline">\(df=\# genotypes − \# alleles\)</span>. This is because the number of genotypes in a population can not vary freely, but is bound to the number of alleles present in that population</li>
</ul>
<hr>
<div class="cell">
<div class="cell-output-display">
<p><img src="class_6_files/figure-html/pvalxsquplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-Allendorf2022" class="csl-entry" role="listitem">
Allendorf, F. W., Funk, W. C., Aitken, S. N., Byrne, M., Luikart, G., &amp; Antunes, A. (2022). <em><span class="nocase">Conservation and the Genomics of Populations</span></em>. Oxford University Press. Retrieved from <a href="https://doi.org/10.1093/oso/9780198856566.001.0001">https://doi.org/10.1093/oso/9780198856566.001.0001</a>
</div>
<div id="ref-Wiki_DoF_2023" class="csl-entry" role="listitem">
Wikipedia contributors. (2023). Degrees of freedom (statistics) — <span>Wikipedia</span><span>,</span> the free encyclopedia. Retrieved from <a href="https://en.wikipedia.org/w/index.php?title=Degrees_of_freedom_(statistics)&amp;oldid=1144691234">https://en.wikipedia.org/w/index.php?title=Degrees_of_freedom_(statistics)&amp;oldid=1144691234</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2024 Giuliano Colosimo</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>. Inspiration for this site comes from <a href="https://www.mm218.dev">here</a>.</div>
  </div>
</footer>



</body></html>